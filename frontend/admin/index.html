<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin - Dashboard</title>
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
  <div id="header"></div>

  <main class="container">
    <h1 class="page-title">Dashboard</h1>

    <section class="grid grid-4 cards-row">
      <div class="card">
        <h3>Sản phẩm</h3>
        <p id="stat-products" class="stat-number">0</p>
      </div>
      <div class="card">
        <h3>Danh mục</h3>
        <p id="stat-categories" class="stat-number">0</p>
      </div>
      <div class="card">
        <h3>Đơn chờ giao</h3>
        <p id="stat-orders" class="stat-number">0</p>
      </div>
      <div class="card">
        <h3>Doanh thu (₫)</h3>
        <p id="stat-sales" class="stat-number">0</p>
      </div>
    </section>

    <section class="card mt">
      <h2>Biểu đồ bán hàng (7 ngày gần nhất)</h2>
      <div id="sales-chart" class="chart"></div>
    </section>

    <section class="card mt">
      <h2>Đơn chờ giao</h2>
      <div id="orders-list"></div>
    </section>
  </main>

  <div id="footer"></div>

  <script src="assets/js/app.js"></script>
  <script>
    // load header/footer và render thống kê
    fetch("layouts/header.html").then(r=>r.text()).then(t=>document.querySelector("#header").innerHTML = t);
    fetch("layouts/footer.html").then(r=>r.text()).then(t=>document.querySelector("#footer").innerHTML = t);

    const db = getDB();
    document.getElementById('stat-products').innerText = db.products.length;
    document.getElementById('stat-categories').innerText = db.categories.length;
    document.getElementById('stat-orders').innerText = db.orders.filter(o=>o.status==='pending').length;
    document.getElementById('stat-sales').innerText = db.orders.reduce((s,o)=>s+o.total,0).toLocaleString();

    // render simple sales chart and pending orders
    renderSalesChart('#sales-chart');
    renderPendingOrders('#orders-list');
  </script>
</body>
</html>
